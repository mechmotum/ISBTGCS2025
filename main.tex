\documentclass[11pt,twocolumn]{article}

\usepackage[margin=0.5in]{geometry}
\usepackage{helvet}
\renewcommand{\familydefault}{\sfdefault}

\title{Fast Symbolic Methods for Muscle-Driven\\Optimal Control and Parameter
Identification}
\author{Jason K. Moore}
\date{\today}

\begin{document}
\maketitle
\section*{INTRODUCTION}
%
Direct collocation has grown rapidly for solving biomechanical optimal control
problems. For example, Opensim now includes Moco which allows users to find
solutions with relatively low user overhead. An advantage of direct collocation
compared to shooting is the speed at which solutions can be found.  The
computation costs can be an orders of magnitude faster with direct collocation.
But direct collocation methods are ultimately local minimzers and computational
cost can increase when searching for global minima.

Direct collocation methods require evaluating the system's equations of motion,
its Jacobian, and possibly its Hessian thousands to millions of times for one
solution, but this evaluation is eaisly parallizable over mutliple compute
cores and can leverage the massive sparsity of the equations. This cannot be,
in general, done in shooting methods that require sequential integration
stepping. Maximizing the compute and memory performance of the functions that
evaluate the constraints and their derivatives allows the subseqent optimization
algorithms to solve very large problems, both in simulation duration and number
of degrees of freedom.

Early, dynamics simulation software used computer aided algebra techniques,
which allowed for analytical derivatives when forming equations of motion, but
this has faded from popularity with growth of numerical physics engines. Code
generated from computer aided algebra can be optimized for evaluation
performance using compiler pre-optimizations and built-in compiler
optimizations that are unlikley available to apply to numeric physics engines.

We will demonstrate software that leverages symbolic formulations to generate
computationally efficient parallelized functions to evaluate the non-linear
programming problem's constraints and its derivatives. We will show an
arm-muscle driven bicycle-rider model that has XM operations for evaluating the
constraints and its Jacobian.

\section*{METHODS}
%
The equations of motion for musculoskeletal system are differnetial algebraic
equations.

\section*{RESULTS AND DISCUSSION}
%
To demonstrate the qualities of our methods we have developed a bicycle-rider
model that includes the non-linear Carvallo-Whipple of the vehicle and with
four additional rigid bodies representing the upper and lower arm body
segements. The arms are added in such a way that no additonal degrees of
freedom are added to the vehicle model due to the closed loop kinematic
constraints. We include four lumped Hill-Type muscle models reprsenting the
extensor and flexor groups for the elbow. This results in a set of differential
algebraic equations with XM floating point operations in the symbolic equations
of motion. The Jacobian of the equations of motion with respect to the states
an muscle excitation inputs has XXM operations. After compiler
preoptimizatoins, this reduces to XK and XM, respectively. Once the constraints
and Jacobian NLP numerical evalution functions are rewritten the evaluation
time depends on the number of nodes. For X nodes we time the evaluation of
these two functions with and without parallelization using from openmp. The
timings are showin Table~\ref{TODO}.

We then solve the optimal control problem defined by the objective to follow a
lane change path with the front wheel.

\section*{CONCLUSIONS}

\end{document}
